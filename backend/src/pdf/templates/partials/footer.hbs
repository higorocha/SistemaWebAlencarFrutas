{{!-- Partial de Rodapé Reutilizável --}}
<div class="pdf-footer" id="pdf-footer">
  <div class="footer-content">
    <!-- Esquerda: Razão Social e CNPJ -->
    <div class="footer-left">
      {{#if empresa}}
        {{#if empresa.razao_social}}
        <p class="footer-empresa">{{empresa.razao_social}}</p>
        {{else}}
        <p class="footer-empresa">{{empresa.nome_fantasia}}</p>
        {{/if}}
        {{#if empresa.cnpj}}
        <p class="footer-cnpj">{{empresa.cnpj}}</p>
        {{/if}}
      {{else}}
      <p class="footer-empresa">Alencar Frutas</p>
      {{/if}}
    </div>
    
    <!-- Centro: Sistemas de Informações - AlencarFrutas -->
    <div class="footer-center">
      <p class="footer-marca">Sistemas de Informações - AlencarFrutas</p>
    </div>
    
    <!-- Direita: Número da Página e Data de Geração -->
    <div class="footer-right">
      <p class="footer-pagina" id="page-number">Página 1</p>
      {{#if dataGeracaoFormatada}}
      <p class="footer-data">Gerado em: {{dataGeracaoFormatada}}</p>
      {{/if}}
    </div>
  </div>
</div>

<script>
  (function() {
    // Calcular número de páginas baseado na altura do conteúdo
    function calcularPaginas() {
      // Altura útil de uma página A4 em pixels (297mm - margens)
      // Margem: 20px top + 20px bottom = 40px
      // Altura A4: 1123px (297mm a 96dpi)
      // Altura útil: 1123 - 40 = 1083px
      const alturaUtilPagina = 1083;
      const alturaConteudo = document.body.scrollHeight;
      const alturaFooter = document.getElementById('pdf-footer')?.offsetHeight || 60;
      const alturaTotal = alturaConteudo - alturaFooter;
      
      const totalPaginas = Math.max(1, Math.ceil(alturaTotal / alturaUtilPagina));
      
      // Atualizar número da página (sempre mostra página 1, pois não temos acesso à página atual no template)
      const pageNumberEl = document.getElementById('page-number');
      if (pageNumberEl) {
        if (totalPaginas > 1) {
          pageNumberEl.textContent = 'Página 1 de ' + totalPaginas;
        } else {
          pageNumberEl.textContent = 'Página 1';
        }
      }
    }
    
    // Executar após carregamento completo
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', calcularPaginas);
    } else {
      calcularPaginas();
    }
    
    // Recalcular após um pequeno delay para garantir que tudo foi renderizado
    setTimeout(calcularPaginas, 100);
  })();
</script>

